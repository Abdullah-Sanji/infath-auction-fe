<header
  class="bg-white px-4 md:px-16 py-0 flex flex-col items-center justify-center relative w-full"
>
  <div
    class="flex items-center justify-between w-full min-h-[72px] relative flex-wrap md:flex-nowrap gap-2 md:gap-0 py-2 md:py-0"
  >
    <div
      class="flex-1 md:flex-1 flex items-center gap-20 min-h-px min-w-px w-full md:w-auto order-3 md:order-0 mt-2 md:mt-0"
    >
      <a
        class="h-[58px] w-[124px] md:w-auto flex items-center justify-start overflow-hidden mx-auto md:mx-0"
        aria-label="إنفاذ"
        [routerLink]="['/']"
      >
        <img
          class="h-full w-auto max-w-full object-contain"
          src="images/icons/company-logo.svg"
          alt="Infath"
        />
      </a>
      <nav class="hidden md:flex items-center justify-end" tAria="nav.ariaMenu">
        @for (item of menuItems(); track item.label) {
          <div class="menu-item-container relative">
            @if (item.children && item.children.length > 0) {
              <!-- Menu item with dropdown -->
              <button
                class="flex items-center justify-center gap-1 h-[72px] px-4 py-2 bg-transparent border-none rounded-sm cursor-pointer text-base font-medium leading-6 text-black transition-colors hover:bg-black/5"
                (click)="toggleDropdown(item.label)"
                [attr.aria-label]="item.ariaLabel | transloco"
                [attr.aria-expanded]="isDropdownOpen(item.label)"
              >
                <span class="text-right whitespace-nowrap">{{ item.label | transloco }}</span>
                @if (item.children && item.children.length > 0) {
                  <img
                    src="images/icons/arrow-black.svg"
                    alt=""
                    class="transition-transform"
                    [class.rotate-180]="isDropdownOpen(item.label)"
                  />
                }
              </button>
              <!-- Dropdown menu -->
              @if (isDropdownOpen(item.label)) {
                <div class="absolute top-full right-0 mt-1 bg-white rounded-sm shadow-lg border border-neutral-200 min-w-[200px] z-50 py-2">
                  @for (child of item.children; track child.label) {
                    <a
                      class="flex items-center px-4 py-2 text-base font-medium leading-6 text-black no-underline transition-colors hover:bg-black/5 text-right whitespace-nowrap"
                      [routerLink]="child.route"
                      [attr.aria-label]="child.ariaLabel | transloco"
                      (click)="closeDropdown()"
                    >
                      {{ child.label | transloco }}
                    </a>
                  }
                </div>
              }
            } @else {
              <!-- Regular menu item without dropdown -->
              <a
                class="flex items-center justify-center gap-1 h-[72px] px-4 py-2 bg-transparent border-none rounded-sm cursor-pointer text-base font-medium leading-6 text-black no-underline transition-colors hover:bg-black/5"
                [routerLink]="item.route"
                [attr.aria-label]="item.ariaLabel | transloco"
              >
                <span class="text-right whitespace-nowrap">{{ item.label | transloco }}</span>
              </a>
            }
          </div>
        }
      </nav>
    </div>
    <div class="flex items-center gap-1 flex-1 md:flex-none justify-end">
      @if (isAuthenticated()) {
      <button
        class="flex items-center justify-center h-[72px] px-1.5 md:px-4 py-2 bg-transparent border-none rounded-sm cursor-pointer text-base font-medium leading-6 text-black transition-colors hover:bg-black/5 min-w-12 md:min-w-0"
        (click)="login()"
      >
        <span class="hidden md:inline">{{ 'nav.login' | transloco }}</span>
      </button>
      } @else {

      <!-- Wallet Section -->
      <div
        class="flex flex-col items-center justify-center h-[72px] px-4 py-2 rounded-sm cursor-pointer transition-colors gap-1 min-w-[72px] relative bg-button-primary text-white"
        (click)="navigateToWallet()"
      >
        <div class="flex items-center gap-1 justify-center">
          <img src="images/icons/wallet.svg" alt="Wallet" class="w-6 h-6 block" />
          <span class="text-base font-medium leading-6 text-white whitespace-nowrap">{{
            walletBalance()
          }}</span>
          <img src="images/icons/currency.svg" alt="SAR" class="w-4 h-[17.882px] block" />
        </div>
        <div class="absolute left-2 right-2 bottom-0 h-1.5 bg-[#56A7B3] rounded-full"></div>
      </div>

      <!-- User Profile Section -->
      <div
        class="flex items-center justify-center h-[72px] px-4 py-2 rounded-sm cursor-pointer transition-colors gap-2"
        (click)="navigateToProfile()"
      >
        <div
          class="relative w-10 h-10 rounded-full bg-neutral-100 border-[1.429px] border-white flex items-center justify-center shadow-[0_0_0_1px_rgba(22,22,22,0.2)]"
        >
          <span class="text-[7.14px] font-bold leading-[10px] text-black text-center">{{
            userInitials()
          }}</span>
        </div>
        <span
          class="hidden md:inline text-base font-medium leading-6 text-black text-right whitespace-nowrap"
          >{{ displayName() }}</span
        >
      </div>

      <!-- Menu Button (Bell Icon) -->
      <button
        class="bg-button-primary flex items-center justify-center max-h-8 max-w-8 min-h-8 min-w-8 border-none rounded-sm cursor-pointer transition-colors hover:bg-primary-700"
        aria-label="Notifications"
      >
        <img src="images/icons/bell.svg" alt="Notifications" class="w-5 h-5 block" />
      </button>
      }
    </div>
  </div>
  <div class="absolute left-0 right-0 bottom-0 h-px bg-neutral-300" aria-hidden="true"></div>
</header>
